!async function(t=49,n=50){let e=new DOMParser;const o="v0.30 by shuashua";console.log("Running popn class script",o,"\nPLZ wait a minute...");const l={a:5e3,b:5e3,c:5e3,d:5e3,e:3e3,f:3e3,g:3e3,h:0,i:0,j:0,k:3e3,none:0},a="https://p.eagate.573.jp/game/popn/jamfizz/playdata",r="https://eacache.s.konaminet.jp/game/popn/jamfizz/images/p/common/medal";function d(t){return t.arrayBuffer().then((n=>t.headers.get("Content-Type").includes("UTF-8")?(new TextDecoder).decode(n):new TextDecoder("Shift_JIS").decode(n)))}console.log(t),console.log(n);let i=[];const h=Array.from({length:n-t+1},((n,e)=>e+t));let s=await Promise.all(h.map((t=>{return n=t,fetch(`${a}/mu_lv.html?page=0&lv=${t}&sort=none&sort_type=none`).then(d).then((t=>e.parseFromString(t,"text/html"))).then((t=>{const n=t.querySelector("#s_page");return n&&n.options?n.options:[]})).then((t=>t.length>0?Array.from(t).map((function(t){return parseInt(t.value,10)})):[0])).then((t=>[n,Math.max(...t)]));var n})));console.log("test result : "+s);for(const[t,n]of s)for(let e=0;e<=n;e++)i.push([e,t]);const p=i.map((([t,n])=>function(t,n){return fetch(t).then(d).then((t=>e.parseFromString(t,"text/html"))).then((t=>t.querySelectorAll("ul.mu_list_table > li"))).then((t=>Array.from(t).filter((t=>t.firstElementChild.className.startsWith("col"))).map((t=>[t.children[3].textContent,t.children[3].firstChild.src.replace(r+"/meda_","").replace(".png",""),t.firstElementChild.children[2].textContent,t.firstElementChild.firstElementChild.textContent])).map((([t,e,o,a])=>({song:a,genre:o,score:t,medal:e,level:n,point:t<5e4?0:Math.floor(100*(1e4*n+parseInt(t)-5e4+l[e])/5440)/100})))))}(`${a}/mu_lv.html?page=${t}&lv=${n}&sort=none&sort_type=none`,n))),c=await fetch(a+"/index.html").then(d).then((t=>e.parseFromString(t,"text/html"))).then((t=>t.querySelector("#status_table > div.st_box > div:nth-child(2)").textContent)),m=(await Promise.all(p)).flat().sort(((t,n)=>t.point===n.point?n.score-t.score:n.point-t.point)).slice(0,70),u=m.slice(0,50),f=m.slice(50);console.log({mainList:u}),console.log({subList:f});const g=u.reduce(((t,n)=>t+n.point),0)/50,b=document.createElement("div");b.id="pokkura",b.innerHTML=`\n  <style scoped>\n  .pokura {\n    display: flex;\n    justify-content: center;\n  }\n  .pokuraTable {\n    background-color: #feffb7;\n    border-collapse: collapse;\n  }\n  .pokuraTable:first-child {\n    margin-right: 10px;\n  }\n  .pokuraTable tr {\n    border-bottom: 2px solid #d82f66;\n  }\n  .pokuraTable th {\n    padding: 4px;\n  }\n  .pokuraTable td {\n    padding: 0 4px;\n  }\n  .pokuraTable td img {\n    vertical-align: middle;\n  }\n  .profileTable {\n    margin: 10px auto;\n    font-size: 14px;\n  }\n  .profileTable td {\n    padding: 5px;\n  }\n  .profileTable td:first-child {\n    font-weight: bold;\n  }\n  .footnote {\n    font-size: 10px;\n    margin: 8px auto;\n    color: gray;\n    text-align: center;\n  }\n  span {\n    display: flex; \n    justify-content: center\n  }\n  @media (max-width: 768px) {\n    .pokura {\n      flex-direction: column;\n    }\n    .pokuraTable {\n      width: 100%;\n      margin-bottom: 20px;\n    }\n    .profileTable {\n      width: auto;\n    }\n    .pokuraTable th:first-child,td:first-child {\n      min-width: 20px;\n    }\n    .pokuraTable th:nth-child(4),td:nth-child(4) {\n      min-width: 40px;\n    }\n    .pokuraTable th:nth-child(5),td:nth-child(5) {\n      min-width: 40px;\n    }\n    .pokuraTable th:nth-child(6),td:nth-child(6) {\n      min-width: 50px;\n    }\n  }\n  </style>\n  <table class="pokuraTable profileTable"><tr><td>플레이어 명</td><td>${c}</td></tr><tr><td>팝 클래스</td><td>${(Math.floor(100*g)/100).toFixed(2)}</td></tr><tr><td>+0.01까지 앞으로</td><td>${Math.ceil(5440*(1-100*g%1)*50/100)}</td></tr></table>\n  <div class="pokura">\n  <table class="pokuraTable">\n    <tr><th>LV</th><th>장르</th><th>곡명</th><th>점수</th><th>메달</th><th>팝 클래스</th></tr>\n    ${u.slice(0,25).map((t=>`<tr><td>${t.level}</td><td>${t.genre}</td><td>${t.song}</td><td>${t.score}</td><td><img src="${r}/meda_${t.medal}.png"></td><td>${t.point.toFixed(2)}</td></tr>`)).join("")}\n  </table>\n  <table class="pokuraTable">\n    <tr><th>LV</th><th>장르</th><th>곡명</th><th>점수</th><th>메달</th><th>팝 클래스</th></tr>\n    ${u.slice(25).map((t=>`<tr><td>${t.level}</td><td>${t.genre}</td><td>${t.song}</td><td>${t.score}</td><td><img src="${r}/meda_${t.medal}.png"></td><td>${t.point.toFixed(2)}</td></tr>`)).join("")}\n  </table>\n  <div>\n    <span>팝클 후보군 리스트</span>\n    <table class="pokuraTable">\n      <tr><th>LV</th><th>장르</th><th>곡명</th><th>점수</th><th>메달</th><th>팝 클래스</th></tr>\n      ${f.map((t=>`<tr><td>${t.level}</td><td>${t.genre}</td><td>${t.song}</td><td>${t.score}</td><td><img src="${r}/meda_${t.medal}.png"></td><td>${t.point.toFixed(2)}</td></tr>`)).join("")}\n    </table>\n  </div>\n  </div>\n  <div class="footnote">팝 클래스 스크립트${o}</div>\n  `,document.body.innerHTML="",document.body.appendChild(b)}(lvs,lve);